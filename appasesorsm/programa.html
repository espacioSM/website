<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aura SM Engine | espacioSM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,wght@0,400;0,700;0,900;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --cat: #FFCD00; --black: #000000; }
        body { font-family: 'Inter', sans-serif; background-color: #ffffff; color: var(--black); }
        .bg-cat { background-color: var(--cat); }
        .border-cat { border-color: var(--cat); }
        .sm-shadow { border: 3px solid var(--black); box-shadow: 10px 10px 0px 0px var(--cat); }
        .btn-sm { border: 2px solid #e5e7eb; transition: 0.2s; padding: 0.8rem; font-weight: 800; font-size: 0.7rem; text-transform: uppercase; text-align: left; }
        .btn-sm:hover, .btn-sm.active { border-color: var(--black); background-color: var(--cat); }
        .input-line { border-bottom: 3px solid var(--black); width: 100%; padding: 10px 0; font-weight: 800; font-size: 1.2rem; text-transform: uppercase; outline: none; }
        .input-line:focus { border-color: var(--cat); }
        .nav-scrolled { background-color: rgba(255, 255, 255, 0.98); border-bottom: 2px solid var(--black); }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="antialiased">

    <nav id="navbar" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 py-4 nav-scrolled">
        <div class="max-w-7xl mx-auto px-6 md:px-12 flex justify-between items-center">
            <a href="https://www.espaciosm.art" class="flex items-center">
                <span class="text-xl font-black italic tracking-tighter">espacio<span class="text-cat not-italic">SM</span></span>
            </a>
            <div class="hidden md:flex items-center space-x-8">
                <a href="#" class="text-[10px] font-black uppercase tracking-widest hover:text-cat">Proyectos</a>
                <a href="#" class="text-[10px] font-black uppercase tracking-widest hover:text-cat">Contacto</a>
                <div class="bg-cat px-3 py-1 text-[9px] font-black uppercase tracking-widest italic border border-black">Aura Engine</div>
            </div>
        </div>
    </nav>

    <main class="pt-32 pb-20 px-6">
        <div class="max-w-2xl mx-auto">
            
            <div class="flex justify-between mb-16 relative px-4">
                <div class="absolute top-5 left-0 w-full h-[1px] bg-gray-100 z-0"></div>
                <div id="prog-line" class="absolute top-5 left-0 h-[2px] bg-black z-0 transition-all duration-700" style="width: 0%;"></div>
                
                <div class="relative z-10 flex flex-col items-center">
                    <div id="d-1" class="w-10 h-10 rounded-full bg-black text-cat flex items-center justify-center border-2 border-cat"><i class="fas fa-id-card text-xs"></i></div>
                    <span class="text-[8px] font-black uppercase mt-2 italic">Contexto</span>
                </div>
                <div class="relative z-10 flex flex-col items-center">
                    <div id="d-2" class="w-10 h-10 rounded-full bg-white border-2 border-gray-100 text-gray-300 flex items-center justify-center"><i class="fas fa-users text-xs"></i></div>
                    <span class="text-[8px] font-black uppercase mt-2">Usuarios</span>
                </div>
                <div class="relative z-10 flex flex-col items-center">
                    <div id="d-3" class="w-10 h-10 rounded-full bg-white border-2 border-gray-100 text-gray-300 flex items-center justify-center"><i class="fas fa-tools text-xs"></i></div>
                    <span class="text-[8px] font-black uppercase mt-2">Equipo</span>
                </div>
                <div class="relative z-10 flex flex-col items-center">
                    <div id="d-4" class="w-10 h-10 rounded-full bg-white border-2 border-gray-100 text-gray-300 flex items-center justify-center"><i class="fas fa-check-double text-xs"></i></div>
                    <span class="text-[8px] font-black uppercase mt-2">Aura Chat</span>
                </div>
            </div>

            <div class="bg-white sm-shadow rounded-sm overflow-hidden">
                <div class="bg-black p-5 flex justify-between items-center text-white border-b-2 border-cat">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-cat rounded-full animate-pulse"></div>
                        <span class="text-[10px] font-black uppercase tracking-[0.3em]">Aura SM Engine</span>
                    </div>
                </div>

                <div id="quiz-area" class="p-8 md:p-12 min-h-[460px] flex flex-col justify-center">
                    </div>

                <div id="tip-box" class="bg-gray-50 border-t-2 border-black p-6 fade-in">
                    <div class="flex gap-4 items-center">
                        <div class="w-10 h-10 rounded-full bg-cat flex items-center justify-center text-xs shadow-sm flex-shrink-0 font-black italic border border-black">SM</div>
                        <div class="space-y-1">
                            <p class="text-[9px] font-black uppercase text-white bg-black px-2 py-0.5 inline-block">Aura Insight</p>
                            <p id="tip-text" class="text-[11px] font-bold italic text-gray-700 leading-relaxed uppercase tracking-tight">Iniciando motor técnico...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        const questions = [
            // FASE 1
            { step: 1, q: "Nombre completo y ocupación", field: "id", type: "multi-input", fields: ["Nombre", "Ocupación"], tip: "Identificar tu perfil nos ayuda a diseñar espacios que potencien tu productividad." },
            { step: 1, q: "¿Ubicación del terreno?", field: "ubicacion", type: "text", tip: "La ubicación geográfica dicta el cálculo de cimentación y normativa local." },
            { step: 1, q: "¿Cuentas con licencia?", field: "licencia", type: "options", options: ["Sí", "No", "Tratar con Arq. San Miguel"], tip: "La licencia es la base legal. Sin ella, el Arq. San Miguel validará tu estrategia de regularización." },
            
            // FASE 2
            { step: 2, q: "¿Cuántos usuarios habitarán la casa? (Mínimo 1)", field: "habitantes_num", type: "number", min: 1, tip: "El número de habitantes determina el volumen de agua y carga eléctrica necesaria." },
            { step: 2, q: "Tipo de habitantes (Multiselección)", field: "habitantes_tipo", type: "multiple", options: ["Infante", "Joven", "Adulto", "Adulto Mayor"], tip: "Diseñamos accesibilidad universal basada en la edad de los usuarios." },
            
            // FASE 3
            { step: 3, q: "¿Cuántos vehículos posee?", field: "autos_num", type: "number", min: 0, tip: "Calculamos el radio de giro para maniobras seguras en tu cochera." },
            { step: 3, q: "Tipo de vehículo (Multiselección)", field: "autos_tipo", type: "multiple", options: ["Sedán", "SUV", "PickUp", "Moto", "Eléctrico"], tip: "Los autos eléctricos requieren preparación de carga especializada." },
            { step: 3, q: "¿Posees mascotas?", field: "mascotas", type: "options-plus", options: ["Perro", "Gato", "Otro"], tip: "Las mascotas influyen en la durabilidad y tipo de pisos seleccionados." },
            { step: 3, q: "¿Requieres equipamiento especial?", field: "especiales", type: "multiple-plus", options: ["Estudio", "Taller", "Gimnasio", "Piano", "Pecera", "Otro"], tip: "Equipos pesados o específicos requieren refuerzos de carga en losas." },
            
            // FASE 4: AURA CHAT
            { step: 4, q: "Aura SM Chat: ¿Alguna duda o ajuste final?", field: "final_chat", type: "chat", tip: "Esta es tu oportunidad de afinar detalles directamente con Aura antes del reporte." }
        ];

        let current = 0;
        let data = {};
        let selectedMultiple = [];
        let log = [];

        function render() {
            const q = questions[current];
            const area = document.getElementById('quiz-area');
            document.getElementById('tip-text').innerText = q.tip;
            updateProgress();

            let html = `<div class="fade-in space-y-6">
                <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Pregunta ${current + 1}</p>
                <h2 class="text-xl font-black uppercase italic border-l-8 border-black pl-4">${q.q}</h2>`;

            if (q.type === "multi-input") {
                q.fields.forEach(f => {
                    html += `<input type="text" id="${f}" placeholder="${f.toUpperCase()}" class="input-line mb-4">`;
                });
            } else if (q.type === "text") {
                html += `<input type="text" id="ans" class="input-line" placeholder="ESCRIBE AQUÍ...">`;
            } else if (q.type === "number") {
                html += `<input type="number" id="ans" min="${q.min}" class="input-line text-4xl" value="${q.min}">`;
            } else if (q.type === "options" || q.type === "options-plus") {
                html += `<div class="grid grid-cols-1 gap-3">`;
                q.options.forEach(opt => html += `<button onclick="saveNext('${opt}')" class="btn-sm">${opt}</button>`);
                html += `</div>`;
                if(q.type === "options-plus") html += `<input type="text" id="other-val" class="input-line mt-4 text-sm" placeholder="ESPECIFICA OTRO...">`;
            } else if (q.type === "multiple" || q.type === "multiple-plus") {
                html += `<div class="grid grid-cols-2 gap-3">`;
                q.options.forEach(opt => {
                    const act = selectedMultiple.includes(opt) ? 'active' : '';
                    html += `<button onclick="toggleM('${opt}')" class="btn-sm ${act}">${opt}</button>`;
                });
                html += `</div>`;
                if(q.type === "multiple-plus") html += `<input type="text" id="other-val" class="input-line mt-4 text-sm" placeholder="ESPECIFICA OTRO...">`;
            } else if (q.type === "chat") {
                html += `<div class="bg-gray-100 p-4 rounded text-xs italic mb-4 border-l-4 border-cat">Aura: "He analizado tus respuestas. Todo indica un proyecto de alta eficiencia. ¿Hay algo más que deba saber el Arq. San Miguel?"</div>
                         <textarea id="ans" class="w-full border-2 border-black p-4 font-bold text-xs uppercase" rows="4" placeholder="EJ: ME PREOCUPA EL TIEMPO DE OBRA..."></textarea>`;
            }

            if(q.type !== "options") {
                html += `<button onclick="handleNext()" class="w-full bg-black text-white py-5 font-black uppercase text-xs mt-8 hover:bg-cat hover:text-black transition-all">Siguiente Paso</button>`;
            }
            area.innerHTML = html;
        }

        function toggleM(v) {
            const i = selectedMultiple.indexOf(v);
            if(i > -1) selectedMultiple.splice(i, 1); else selectedMultiple.push(v);
            render();
        }

        function handleNext() {
            const q = questions[current];
            let val = "";
            if(q.type === "multi-input") {
                val = q.fields.map(f => document.getElementById(f).value).join(" | ");
            } else if(q.type === "multiple" || q.type === "multiple-plus") {
                const other = document.getElementById('other-val')?.value;
                val = selectedMultiple.join(", ") + (other ? ", OTRO: " + other : "");
                selectedMultiple = [];
            } else {
                val = document.getElementById('ans').value;
                const other = document.getElementById('other-val')?.value;
                if(other) val += " (OTRO: " + other + ")";
            }
            saveNext(val);
        }

        function saveNext(v) {
            const q = questions[current];
            data[q.field || "id"] = v;
            log.push({p: q.q, r: v});
            if(current < questions.length - 1) { current++; render(); }
            else { finish(); }
        }

        function updateProgress() {
            const prog = (current / (questions.length - 1)) * 100;
            document.getElementById('prog-line').style.width = prog + "%";
            for(let i=1; i<=4; i++) {
                const dot = document.getElementById(`d-${i}`);
                if(i <= questions[current].step) dot.classList.add('bg-black', 'text-cat', 'border-cat');
            }
        }

        function finish() {
            const waMsg = `Hola Arq. San Miguel, Aura SM me entregó mi diagnóstico.\n\nNombre: ${data.id}\nProyecto: ${data.tipo_trabajo}\nNotas Aura: ${data.final_chat}`;
            document.getElementById('quiz-area').innerHTML = `
                <div class="text-center space-y-8 fade-in">
                    <h2 class="text-3xl font-black italic uppercase tracking-tighter italic">Diagnóstico <span class="text-cat">espacioSM</span> Generado</h2>
                    <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest px-6 leading-relaxed">Tu programa de necesidades ha sido filtrado por Aura SM Engine y está listo para la revisión del Arq. San Miguel.</p>
                    <a href="https://wa.me/525613870288?text=${encodeURIComponent(waMsg)}" target="_blank" class="block w-full bg-cat text-black py-6 font-black uppercase tracking-[0.2em] text-xs shadow-[10px_10px_0px_0px_rgba(0,0,0,1)] hover:scale-[1.05] transition-transform">Enviar al Arq. San Miguel</a>
                </div>
            `;
        }

        render();
    </script>
</body>
</html>
